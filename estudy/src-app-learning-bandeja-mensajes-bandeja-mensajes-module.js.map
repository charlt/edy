{"version":3,"sources":["webpack:///./src/app/docente/mensajeria/services/mensajeria.service.ts","webpack:///./src/app/learning/bandeja-mensajes/bandeja-mensajes-routing.module.ts","webpack:///./src/app/learning/bandeja-mensajes/bandeja-mensajes.component.html","webpack:///./src/app/learning/bandeja-mensajes/bandeja-mensajes.component.scss","webpack:///./src/app/learning/bandeja-mensajes/bandeja-mensajes.component.ts","webpack:///./src/app/learning/bandeja-mensajes/bandeja-mensajes.module.ts"],"names":[],"mappings":"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","file":"src-app-learning-bandeja-mensajes-bandeja-mensajes-module.js","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Http } from '@angular/http';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nimport { GLOBAL } from 'src/app/services/global';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MensajeriaService {\r\n\r\n  public url: string;\r\n\r\n  constructor(\r\n    private _http: Http,\r\nprivate _httpClient: HttpClient\r\n  ) {\r\n    this.url = GLOBAL.url;\r\n   }\r\n\r\n   cambiaVisto(rol, id_materia,visto, cambios){\r\n    var params = '?rol_id='+rol;\r\n    params += '&id_materia='+id_materia;\r\n    params += '&visto='+visto; //1 visto 0 no visto\r\n    params += '&numero_cambios='+cambios; \r\n  \r\n    return this._httpClient.get(this.url +'learning/mensaje_materia/MarcaVistoMensaje.php'+params);\r\n   }\r\n\r\n   consulta(materia_id,jwt,inicio,final){\r\n    \r\n    var params = '?id_materia='+materia_id;\r\n    params += '&limit_inicio='+inicio;\r\n    params += '&limit_final='+final;\r\n    params += '&jwt='+jwt;\r\n    \r\n    return this._httpClient.get(this.url +'/learning/mensaje_materia/consulta.php'+params);\r\n  }\r\n\r\n  consultaBandejaMensajes( tipo){    \r\n    var params = '?nuevos='+tipo;\r\n    return this._httpClient.get(this.url +'/controlEscolar/mensajeria/mensajesDocente.php'+params);\r\n   }\r\n\r\n   consultaBandejaMensajesAlumno( tipo){    \r\n    var params = '?nuevos='+tipo;\r\n    return this._httpClient.get(this.url +'/controlEscolar/mensajeria/mensajesAlumno.php'+params);\r\n   }\r\n   \r\n\r\n  enviar(persona_id,materia_id,texto,origen,jwt,mensaje_id=null){\r\n\r\n    let formData: FormData = new FormData(); \r\n    \r\n    formData.append('persona_id', persona_id);\r\n    formData.append('materia_id', materia_id);\r\n    formData.append('texto', texto);\r\n    formData.append('origen', origen);\r\n    formData.append('jwt', jwt);\r\n\r\n    if(!mensaje_id){\r\n      return this._httpClient.post(this.url +'learning/mensaje_materia/crea.php',formData);\r\n    }\r\n  }\r\n\r\n  getTotalMensajes(jwt, materia_id){\r\n    var params = '?id_materia='+materia_id;\r\n    params += '&jwt='+jwt;\r\n    \r\n    return this._httpClient.get(this.url +'/controlEscolar/notificaciones/totalMensajeriaMateria.php'+params);\r\n  }\r\n  \r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { BandejaMensajesComponent } from './bandeja-mensajes.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path:'',\r\n    component: BandejaMensajesComponent\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class BandejaMensajesRoutingModule { }\r\n","module.exports = \"<div class=\\\"row\\\">\\r\\n  <div class=\\\"col-md-12\\\">\\r\\n    <h4>{{title}}</h4>\\r\\n  </div>\\r\\n  <div class=\\\"col-md-12\\\">\\r\\n    <div class=\\\"btn-group\\\" role=\\\"group\\\" aria-label=\\\"Basic example\\\">\\r\\n      <button type=\\\"button\\\" class=\\\"btn btn-info\\\" [ngClass]=\\\"ident == 0 ? 'active':''\\\" (click)=\\\"consultaMensajes(0)\\\">Todos</button>\\r\\n      <button type=\\\"button\\\" class=\\\"btn btn-info\\\" [ngClass]=\\\"ident == 1 ? 'active':''\\\" (click)=\\\"consultaMensajes(1)\\\">Nuevos</button>      \\r\\n    </div><br><br>\\r\\n    <table class=\\\"table table-striped table-bordered\\\">\\r\\n      <thead>\\r\\n        <tr>\\r\\n          <th>Asignatura</th>\\r\\n          <th>Docente</th>\\r\\n          <th>Fecha del último envio</th>\\r\\n          <th>Número de mensajes</th>\\r\\n          <th>Ir a la asignatura</th>\\r\\n        </tr>\\r\\n      </thead>\\r\\n      <tbody *ngIf=\\\"mensajes\\\">\\r\\n        <tr *ngFor = \\\"let mensaje of mensajes\\\">\\r\\n          <td>{{mensaje.asignatura}}</td>\\r\\n          <td>{{mensaje.docente.nombre}} {{mensaje.docente.primer_apellido}} {{mensaje.docente.segundo_apellido}}</td>\\r\\n          <td class=\\\"text-center\\\">{{mensaje.ultimo_mensaje | date: \\\"dd/MM/yyyy\\\"}} {{mensaje.ultimo_mensaje |date:\\\"shortTime\\\" }}</td>\\r\\n          <td class=\\\"text-center\\\">{{mensaje.total_mensajes}}</td>\\r\\n          <td class=\\\"text-center\\\">\\r\\n            <button [disabled]=\\\"cargandoRedireccion\\\" type=\\\"button\\\" class=\\\"btn btn-primary\\\" (click)=\\\"seleccionaMateria(mensaje.materia_id);\\\">\\r\\n              <i class=\\\"fa fa-arrow-up\\\" aria-hidden=\\\"true\\\"></i></button>\\r\\n          </td>\\r\\n        </tr>\\r\\n      </tbody>\\r\\n      <tbody *ngIf=\\\"!mensajes\\\">\\r\\n        <tr >\\r\\n          <td colspan=\\\"20\\\" class=\\\"text-center p-3\\\">\\r\\n            <span>No se encontraron mensajes</span>\\r\\n          </td>\\r\\n        </tr>\\r\\n      </tbody>\\r\\n    </table>\\r\\n  </div>\\r\\n</div>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2xlYXJuaW5nL2JhbmRlamEtbWVuc2FqZXMvYmFuZGVqYS1tZW5zYWplcy5jb21wb25lbnQuc2NzcyJ9 */\"","import { Component, OnInit } from '@angular/core';\r\nimport { MensajeriaService } from 'src/app/docente/mensajeria/services/mensajeria.service';\r\nimport { UsuarioService } from 'src/app/services/usuario.service';\r\nimport { MateriaService } from 'src/app/services/materia.service';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-bandeja-mensajes',\r\n  templateUrl: './bandeja-mensajes.component.html',\r\n  styleUrls: ['./bandeja-mensajes.component.scss']\r\n})\r\nexport class BandejaMensajesComponent implements OnInit {\r\n  title;\r\n  ident = 0;\r\n  mensajes;\r\n  cargandoRedireccion;\r\n\r\n  constructor(\r\n    private _usuarioService: UsuarioService,\r\n    private _mensajeService: MensajeriaService,\r\n    private _materiaService: MateriaService,\r\n    private _router: Router,\r\n\r\n  ){\r\n    this.title='Consulta mensajes';\r\n   }\r\n\r\n  ngOnInit(){\r\n    this.consultaMensajes(0);\r\n  }\r\n\r\n  consultaMensajes(tipo){\r\n    this.ident = tipo;\r\n    this._mensajeService.consultaBandejaMensajesAlumno(tipo).subscribe(\r\n      response =>{\r\n          if(response && response['status']){\r\n            this.mensajes = response['mensajes'];\r\n            this.mensajes.forEach(mensaje => {\r\n              let fecha = new Date(mensaje.ultimo_mensaje * 1000);\r\n              mensaje.ultimo_mensaje = fecha;\r\n            });\r\n            console.log(this.mensajes);\r\n            \r\n          }else{\r\n            this.mensajes = null;\r\n          }\r\n    });\r\n  }\r\n\r\n  seleccionaMateria(id_materia){\r\n    this._materiaService.seleccionaMateria(id_materia,'').then(\r\n      (data:any)=>{\r\n        this._router.navigate(['/materia/mensajes/'+id_materia]);\r\n      }\r\n    );\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { BandejaMensajesRoutingModule } from './bandeja-mensajes-routing.module';\r\nimport { BandejaMensajesComponent } from './bandeja-mensajes.component';\r\n\r\n@NgModule({\r\n  declarations: [BandejaMensajesComponent],\r\n  imports: [\r\n    CommonModule,\r\n    BandejaMensajesRoutingModule\r\n  ],\r\n  exports:[BandejaMensajesComponent]\r\n})\r\nexport class BandejaMensajesModule { }\r\n"],"sourceRoot":""}