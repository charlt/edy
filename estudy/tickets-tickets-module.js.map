{"version":3,"sources":["webpack:///./src/app/administracion/tickets/servicios/tickets.service.ts","webpack:///./src/app/administracion/tickets/tickets-routing.module.ts","webpack:///./src/app/administracion/tickets/tickets.component.html","webpack:///./src/app/administracion/tickets/tickets.component.scss","webpack:///./src/app/administracion/tickets/tickets.component.ts","webpack:///./src/app/administracion/tickets/tickets.module.ts"],"names":[],"mappings":"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","file":"tickets-tickets-module.js","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { GLOBAL } from \"src/app/services/global\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TicketsService {\r\n\r\n  url: string = GLOBAL.url;\r\n\r\n  constructor(\r\n    private httpClient: HttpClient\r\n  ) { }\r\n\r\n  getConteoTickets() {\r\n    return this.httpClient.get(this.url + 'controlEscolar/tickets/conteoEstatusTicket.php');\r\n  }\r\n\r\n  consultaTipoTicket() {\r\n    return this.httpClient.get(this.url + '/catalogosCE/consultaTipoTiket.php');\r\n  }\r\n\r\n  consultaTicket(id_estatus) {\r\n    let params = new HttpParams()\r\n      .set('id_estatus_ticket', id_estatus);\r\n    \r\n    return this.httpClient.get(this.url + 'controlEscolar/tickets/consultaPorEstatus.php', { params: params });\r\n  }\r\n\r\n  consultaPorTicket(id_ticket) {\r\n    let params = new HttpParams()\r\n      .set('id_ticket', id_ticket);\r\n\r\n    return this.httpClient.get(this.url + 'controlEscolar/tickets/consultaTicket.php', { params: params });\r\n  }\r\n\r\n  consultaRespuestas(id_ticket) {\r\n    let params = new HttpParams()\r\n      .set('id_ticket', id_ticket);\r\n\r\n    return this.httpClient.get(this.url + 'controlEscolar/tickets/consultaRespuestas.php', { params: params });\r\n  }\r\n\r\n  guardarRespuesta(id_ticket, form) {    \r\n    let formData = new FormData();\r\n      formData.append('id_ticket', id_ticket);\r\n      formData.append('texto', form.texto);\r\n\r\n    return this.httpClient.post(this.url + 'controlEscolar/tickets/creaRespuesta.php', formData);\r\n  }\r\n\r\n  guardaTicketCorreccion(form, idPersona, idRol, idRolUsuario) {\r\n    let formData: FormData = new FormData();    \r\n    formData.append('asunto_ticket', form.asunto);\r\n    formData.append('descripcion_ticket', form.mensaje);\r\n    formData.append('id_tipo_ticket', form.tipoTicket);\r\n    if (idRol == 1) {\r\n      formData.append('id_persona', idPersona);\r\n      formData.append('id_rol', idRolUsuario);\r\n      formData.append('id_area', '1');\r\n      formData.append('id_rol_admin', idRol);\r\n      return this.httpClient.post(this.url + 'controlEscolar/tickets/crearNotificacion.php', formData);\r\n    }else if (idRol == 2) {\r\n      return this.httpClient.post(this.url + 'controlEscolar/tickets/crearTicket.php', formData);\r\n    }\r\n  }\r\n\r\n  ticketVisto(id_ticket){\r\n\r\n    var params = '?id_ticket='+id_ticket;\r\n  \r\n    return this.httpClient.get(this.url +'general/tickets/ticketVisto.php'+params);\r\n  }\r\n\r\n  cerrarTicket(id_ticket) {\r\n    let formData = new FormData();\r\n      formData.append('id_ticket', id_ticket);\r\n    return this.httpClient.post(this.url +'controlEscolar/tickets/cerrarTicket.php', formData);\r\n  }\r\n\r\n  eliminarTicket(id_ticket) {\r\n    let formData = new FormData();\r\n      formData.append('id_ticket', id_ticket);\r\n    return this.httpClient.post(this.url +'controlEscolar/tickets/eliminarTicket.php', formData);\r\n  }\r\n\r\n}","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { TicketsComponent } from './tickets.component';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: TicketsComponent }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class TicketsRoutingModule { }\r\n","module.exports = \"<div class=\\\"row\\\">\\r\\n  <div class=\\\"col-12\\\">\\r\\n    <div *ngIf=\\\"!EstatusTickets\\\" class=\\\"container border rounded text-center p-4\\\">\\r\\n      <h5>No se encontraron tickets abiertos</h5>\\r\\n    </div>\\r\\n    <ngb-tabset #tabset=\\\"ngbTabset\\\" (tabChange)=\\\"getTab($event.nextId)\\\" *ngIf=\\\"EstatusTickets\\\">\\r\\n      <ngb-tab [id]=\\\"'tab-'+ i\\\" title=\\\"{{ item.estatus_ticket | titlecase }} ({{item.total}})\\\" *ngFor=\\\"let item of EstatusTickets; let i = index;\\\">\\r\\n        <ng-template ngbTabContent>\\r\\n          <div class=\\\"table-responsive mt-3\\\">\\r\\n            <table class=\\\"table table-border\\\">\\r\\n              <thead class=\\\"bg-light\\\">\\r\\n                <tr>\\r\\n                  <th>Asunto del ticket</th>\\r\\n                  <th>Descripción</th>\\r\\n                  <th>Nombre alumno</th>\\r\\n                  <th>Tipo de ticket</th>\\r\\n                  <th>\\r\\n                    <span *ngIf=\\\"item.estatus_ticket_id != 4\\\">Responder</span>\\r\\n                    <span *ngIf=\\\"item.estatus_ticket_id == 4\\\">Ver ticket</span>\\r\\n                  </th>\\r\\n                </tr>\\r\\n              </thead>\\r\\n              <tbody>\\r\\n                <tr *ngFor=\\\"let ticket of Tickets; let j = index;\\\">\\r\\n                  <td>{{ticket.asunto_ticket}}</td>\\r\\n                  <td>{{ticket.descripcion_ticket}}</td>\\r\\n                  <td>{{ticket.primer_apellido}} {{ticket.segundo_apellido}} {{ticket.nombre}}</td>\\r\\n                  <td>{{ticket.tipo_ticket}}</td>\\r\\n                  <td>\\r\\n                    <button *ngIf=\\\"item.estatus_ticket_id != 4\\\" class=\\\"btn btn-primary\\\" (click)=\\\"open(content, ticket)\\\"><i class=\\\"fa fa-ticket\\\"></i></button>\\r\\n                    <button *ngIf=\\\"item.estatus_ticket_id == 4\\\" class=\\\"btn btn-primary\\\" (click)=\\\"open(content, ticket)\\\"><i class=\\\"fa fa-eye\\\"></i></button>\\r\\n                  </td>\\r\\n                </tr>\\r\\n              </tbody>\\r\\n            </table>\\r\\n          </div>\\r\\n        </ng-template>\\r\\n      </ngb-tab>\\r\\n    </ngb-tabset>\\r\\n  </div>\\r\\n</div>\\r\\n\\r\\n<ng-template #content let-modal>\\r\\n  <div class=\\\"modal-body p-3\\\">\\r\\n    <button type=\\\"button\\\" class=\\\"close\\\" aria-label=\\\"Close\\\" (click)=\\\"modal.close()\\\">\\r\\n      <span aria-hidden=\\\"true\\\">&times;</span>\\r\\n    </button>\\r\\n    <div class=\\\"row\\\">\\r\\n      <div class=\\\"col-12\\\">\\r\\n        <div class=\\\"container p-4 border rounded\\\">\\r\\n          <div class=\\\"card\\\">\\r\\n            <div class=\\\"card-body py-1\\\">\\r\\n              <h5 class=\\\"modal-title mt-2\\\" id=\\\"modal-basic-title\\\"> {{selected.asunto_ticket}}</h5>\\r\\n              <p>{{selected.descripcion_ticket}}</p>\\r\\n            </div>\\r\\n          </div>\\r\\n          \\r\\n          <div class=\\\"py-2\\\" *ngIf=\\\"Respuestas\\\">\\r\\n            <b>Respuestas:</b>\\r\\n            <div *ngFor=\\\"let respuesta of Respuestas\\\">\\r\\n              <div class=\\\"alert\\\" [ngClass]=\\\"(idRol == 1 && (respuesta.rol_id == 2 || respuesta.rol_id == 4))? \\r\\n                'alert-secondary': (idRol == 1 && respuesta.rol_id == 1)? 'alert-primary' : ''\\\" role=\\\"alert\\\">\\r\\n                <div class=\\\"row\\\">\\r\\n                  <div class=\\\"col-12 my-0 py-0\\\">\\r\\n                    <small class=\\\"m-0 p-0 pull-right\\\">{{respuesta.fecha_creacion | date: 'dd/MM/yyyy hh:mm a'}}</small>\\r\\n                  </div>\\r\\n                  <div class=\\\"col-12 my-0 py-0\\\">\\r\\n                    <p class=\\\"m-0 p-0\\\">{{respuesta.texto}}</p>\\r\\n                  </div>\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n          <div [ngClass]=\\\"!Respuestas? 'pt-2': ''\\\">\\r\\n            <form *ngIf=\\\"idEstatus != 4 && ticketsForm\\\" [formGroup]=\\\"ticketsForm\\\" (ngSubmit)=\\\"guardaRespuesta()\\\">\\r\\n                <div class=\\\"form-group\\\">\\r\\n                  <textarea formControlName=\\\"texto\\\" placeholder=\\\"Escribe texto\\\" class=\\\"form-control\\\" rows=\\\"3\\\"></textarea>\\r\\n                </div>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-warning btn-sm\\\" (click)=\\\"cerrarTicket()\\\" [disabled]=\\\"ticketsForm.invalid\\\"><i class=\\\"fa fa-minus-square \\\"></i> Cerrar ticket</button>\\r\\n                <button [hidden]=\\\"tipoAdmin == 0\\\" type=\\\"submit\\\" [disabled]=\\\"ticketsForm.invalid\\\" class=\\\"btn btn-success pull-right\\\">Enviar respuesta</button>\\r\\n            </form>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n\\r\\n</ng-template>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FkbWluaXN0cmFjaW9uL3RpY2tldHMvdGlja2V0cy5jb21wb25lbnQuc2NzcyJ9 */\"","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { TicketsService } from './servicios/tickets.service';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { UsuarioService } from 'src/app/services/usuario.service';\r\n\r\ndeclare var alertify: any;\r\n\r\n@Component({\r\n  selector: 'app-tickets',\r\n  templateUrl: './tickets.component.html',\r\n  styleUrls: ['./tickets.component.scss']\r\n})\r\nexport class TicketsComponent implements OnInit {\r\n\r\n  EstatusTickets: any;\r\n  activeTab: number;\r\n  Tickets: Array<any>;\r\n  selected: any;\r\n  ticketsForm: FormGroup;\r\n  Respuestas: any;\r\n  idRol: any;\r\n  tipoAdmin;\r\n  idEstatus: any;\r\n\r\n  @ViewChild('tabset') tabset;\r\n\r\n  constructor(\r\n    private _ticketsService: TicketsService,\r\n    private modalService: NgbModal,\r\n    private formBuilder: FormBuilder,\r\n    private _usuarioService: UsuarioService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.idRol = this._usuarioService.getRol().rol_id;\r\n    let identity = this._usuarioService.getIdentity();\r\n    if(identity.administrador)\r\n      this.tipoAdmin = identity.administrador.edicion;\r\n    else\r\n      this.tipoAdmin = 1;;\r\n    this.conteoTickets();\r\n  }\r\n\r\n  conteoTickets(id = 0, tab = 0) {\r\n    this.EstatusTickets = undefined;\r\n    this._ticketsService.getConteoTickets().subscribe(response => {\r\n      if (response && response['status']) {\r\n        this.EstatusTickets = response['tickets'];         \r\n        this.getTab('tab-' + tab);\r\n        if (id = 1) this.modalService.dismissAll();\r\n      }\r\n    }, error => {\r\n      console.log(<any>error);\r\n    });\r\n  }\r\n\r\n  getTab(id) {                    \r\n    let array = id.split('tab-');\r\n    this.activeTab = parseInt(array[1]); \r\n    this.idEstatus = this.EstatusTickets[this.activeTab]['estatus_ticket_id'];      \r\n    this._ticketsService.consultaTicket(this.idEstatus).subscribe(response => {  \r\n      if (response && response['status']) {\r\n        this.Tickets = response['ticket'];   \r\n        setTimeout(() => {          \r\n          this.tabset.select(id);\r\n        }, 1); \r\n      }else {\r\n        this.Tickets = null;\r\n      }      \r\n    }, error => {\r\n      console.log(<any>error);\r\n    });\r\n  }\r\n\r\n  get f() { return this.ticketsForm.controls }\r\n\r\n  open(content, ticket) {    \r\n    this.selected = ticket;\r\n    this.Respuestas = undefined;\r\n    if (!this.ticketsForm && this.idEstatus != 4) {      \r\n      this.ticketsForm = this.formBuilder.group({\r\n        texto: ['', Validators.required]\r\n      });\r\n    }else if(this.ticketsForm && this.idEstatus != 4) {\r\n      this.ticketsForm.get('texto').setValue('');\r\n    }  \r\n      \r\n    this._ticketsService.consultaRespuestas(this.selected['ticket_id']).subscribe(response => {  \r\n      if (response && response['status']) {\r\n        this.Respuestas = response['Respuestas'];        \r\n      }\r\n      this.modalService.open(content, { keyboard: false, size: 'lg', backdrop: 'static' });\r\n    }, error => {\r\n      console.log(<any>error);\r\n    });\r\n  }\r\n\r\n  guardaRespuesta(id = 0) {\r\n    let form = this.ticketsForm.value;\r\n    this._ticketsService.guardarRespuesta(this.selected['ticket_id'], form).subscribe(response => {  \r\n      if (response && response['status']) {\r\n        if (id == 0) {\r\n          this.conteoTickets(1, this.activeTab);\r\n          alertify.success(response['msg']).dismissOthers();\r\n        }\r\n        else if (id == 1) {\r\n          this._ticketsService.cerrarTicket(this.selected['ticket_id']).subscribe(response =>{\r\n            if(response && response['status']){\r\n              this.conteoTickets(1, this.activeTab);\r\n              alertify.success(response['msg']).dismissOthers();\r\n            }\r\n            },error =>{\r\n              console.log(<any>error)\r\n          });\r\n        }\r\n      }\r\n    }, error => {\r\n      console.log(<any>error);\r\n    });\r\n  }\r\n\r\n  cerrarTicket() {\r\n    alertify.confirm('Cerrar ticket', `¿Deseas cerrar el ticket?`, function() { \r\n      this.guardaRespuesta(1);\r\n    }.bind(this), \r\n    function() { \r\n      alertify.error('Cancelado').dismissOthers();\r\n    });\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { TicketsRoutingModule } from './tickets-routing.module';\r\nimport { TicketsComponent } from './tickets.component';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  declarations: [TicketsComponent],\r\n  imports: [\r\n    CommonModule,\r\n    TicketsRoutingModule,\r\n    NgbModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    TranslateModule\r\n  ],\r\n  exports: [TicketsComponent]\r\n})\r\nexport class TicketsModule { }\r\n"],"sourceRoot":""}